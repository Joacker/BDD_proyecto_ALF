/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Main;

import Conexion.Conexion;
import Registro.Paciente;
import java.awt.event.KeyEvent;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Fernando
 */
public class Main extends javax.swing.JFrame {

    Conexion conect = new Conexion();
    DefaultTableModel modelo;
    
    public Main() {
        initComponents();
        this.setLocationRelativeTo(null);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        jLabel19 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        ComboBoxCentroDeSalud = new javax.swing.JComboBox<>();
        jLabel1 = new javax.swing.JLabel();
        nombre = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        rut = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        edad = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        femenino = new javax.swing.JRadioButton();
        masculino = new javax.swing.JRadioButton();
        jLabel5 = new javax.swing.JLabel();
        ComboBoxEstados = new javax.swing.JComboBox<>();
        jLabel6 = new javax.swing.JLabel();
        patologia = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        tratamiento = new javax.swing.JTextField();
        estado = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jLabel10 = new javax.swing.JLabel();
        idBusqueda = new javax.swing.JTextField();
        BusquedaPorId = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        nombreRespuesta = new javax.swing.JTextField();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        mRest = new javax.swing.JRadioButton();
        fRest = new javax.swing.JRadioButton();
        edadRespuesta = new javax.swing.JTextField();
        rutRespuesta = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        patologiaRespuesta = new javax.swing.JTextField();
        tratamientoRespuesta = new javax.swing.JTextField();
        estadoRespuesta = new javax.swing.JTextField();
        estadoPaisRespuesta = new javax.swing.JComboBox<>();
        ActualizarDatos = new javax.swing.JButton();
        jPanel7 = new javax.swing.JPanel();
        jLabel21 = new javax.swing.JLabel();
        rutBusqueda = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        Buscar = new javax.swing.JButton();
        jLabel22 = new javax.swing.JLabel();
        idABorrar = new javax.swing.JTextField();
        borrarPaciente = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jLabel11 = new javax.swing.JLabel();
        comboBoxConsultas = new javax.swing.JComboBox<>();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        Consultar = new javax.swing.JButton();

        jLabel19.setText("jLabel19");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jTabbedPane1.setFont(new java.awt.Font("Segoe UI", 1, 24)); // NOI18N

        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Ingreso de paciente", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 18))); // NOI18N

        ComboBoxCentroDeSalud.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "LOBORTIS ASSOCIATES", "PELLENTESQUE INDUSTRIES", "ANTE LTD", "DOLOR COMPANY", "VESTIBULUM INSTITUTE", "NUNC INTERDUM INDUSTRIES", "EST FOUNDATION", "VIVAMUS NON LOREM INC.", "ELIT PEDE INCORPORATED", "MAURIS IPSUM PORTA LIMITED", "SEMPER TELLUS PC", "NON PC", "NON LOREM VITAE LLC", "NULLA FACILISIS CORP.", "ENIM INDUSTRIES", "VELIT INC.", "ELEIFEND NUNC CORPORATION", "ARCU SED ET PC", "IPSUM LLC", "ALIQUAM INC.", "ID CORP.", "BIBENDUM FERMENTUM CORP.", "QUIS ACCUMSAN CONVALLIS LTD", "BLANDIT LLP", "EST MAURIS EU LTD", "AMET RISUS FOUNDATION", "INTEGER SEM ELIT LLC", "DIGNISSIM COMPANY", "SEMPER NAM TEMPOR LTD", "AC FEUGIAT NON INSTITUTE", "EU INDUSTRIES", "MALESUADA INTEGER ID LLP", "DONEC DIGNISSIM LIMITED", "URNA CONVALLIS LTD", "UT MI DUIS CONSULTING", "EU FOUNDATION", "ARCU ALIQUAM INDUSTRIES", "ALIQUET LOBORTIS NISI ASSOCIATES", "ANTE LTD", "ET CORP.", "FEUGIAT LLC", "ETIAM VESTIBULUM ASSOCIATES", "RIDICULUS ASSOCIATES", "A INCORPORATED", "IN LOREM DONEC LIMITED", "LIGULA INSTITUTE", "DONEC CONSECTETUER LTD", "DIGNISSIM INSTITUTE", "ETIAM VESTIBULUM MASSA LIMITED", "RUTRUM LLC", "EGESTAS INC.", "AMET INDUSTRIES", "SED ID PC", "MI INDUSTRIES", "SED INC.", "IPSUM FOUNDATION", "LIBERO ET INCORPORATED", "HABITANT MORBI TRISTIQUE CORP.", "ERAT VOLUTPAT LIMITED", "FERMENTUM FOUNDATION", "ETIAM VESTIBULUM CONSULTING", "TELLUS ID INC.", "QUIS CORPORATION", "ELIT PC", "INTEGER TINCIDUNT ALIQUAM INDUSTRIES", "LOBORTIS CORP.", "PROIN CONSULTING", "NEC CONSULTING", "AENEAN PC", "LOREM LUCTUS LLC", "SCELERISQUE MOLLIS PHASELLUS LTD", "PURUS MAECENAS LTD", "PER INCEPTOS LTD", "ARCU SED LIMITED", "DICTUM PHASELLUS IN INDUSTRIES", "NISI A ODIO LTD", "SAGITTIS AUGUE COMPANY", "RIDICULUS MUS PROIN CONSULTING", "VULPUTATE VELIT INC.", "VENENATIS VEL FAUCIBUS FOUNDATION", "FAMES AC INDUSTRIES", "TELLUS AENEAN EGESTAS INDUSTRIES", "ULTRICES IACULIS PC", "ET TRISTIQUE PELLENTESQUE CONSULTING", "NEC PC", "AC TELLUS CORPORATION", "NULLA ALIQUET LIMITED", "MAURIS IPSUM PORTA PC", "VULPUTATE POSUERE VULPUTATE INC.", "SED NULLA ANTE LTD", "SEMPER LIMITED", "VULPUTATE POSUERE VULPUTATE LLP", "CONDIMENTUM EGET ASSOCIATES", "LUCTUS VULPUTATE PC", "NULLA TINCIDUNT CORPORATION", "ULLAMCORPER INCORPORATED", "ENIM INCORPORATED", "NUNC INDUSTRIES", "ORCI LOBORTIS LIMITED", "METUS AENEAN SED INCORPORATED" }));
        ComboBoxCentroDeSalud.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ComboBoxCentroDeSaludActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel1.setText("Centro Medico");

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel2.setText("Nombre");

        jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel4.setText("Rut");

        edad.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                edadKeyTyped(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel3.setText("Edad");

        buttonGroup1.add(femenino);
        femenino.setText("Femenino");

        buttonGroup1.add(masculino);
        masculino.setSelected(true);
        masculino.setText("Masculino");
        masculino.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                masculinoActionPerformed(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel5.setText("Sexo");

        ComboBoxEstados.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "Florida", "Georgia", "Hawaii", "Idaho", "IllinoisIndiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "MontanaNebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "PennsylvaniaRhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming" }));

        jLabel6.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel6.setText("Estado del pais");

        jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel7.setText("Patologia");

        jLabel8.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel8.setText("Tratamiento");

        jLabel9.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel9.setText("Estado");

        jButton1.setText("Ingresar");
        jButton1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jButton1MouseClicked(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(8, 8, 8)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel9)
                            .addComponent(jLabel8)
                            .addComponent(jLabel1)
                            .addComponent(jLabel2)
                            .addComponent(jLabel4)
                            .addComponent(jLabel3)
                            .addComponent(jLabel5)
                            .addComponent(jLabel6)
                            .addComponent(jLabel7))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(masculino)
                                .addGap(18, 18, 18)
                                .addComponent(femenino))
                            .addComponent(ComboBoxCentroDeSalud, javax.swing.GroupLayout.PREFERRED_SIZE, 211, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(nombre)
                            .addComponent(rut)
                            .addComponent(edad)
                            .addComponent(ComboBoxEstados, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(tratamiento)
                            .addComponent(patologia)
                            .addComponent(estado)))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(166, 166, 166)
                        .addComponent(jButton1)))
                .addContainerGap(85, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ComboBoxCentroDeSalud, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nombre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rut, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel4))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(edad, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(masculino)
                    .addComponent(femenino)
                    .addComponent(jLabel5))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(ComboBoxEstados, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel8)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(patologia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel7))
                        .addGap(18, 18, 18)
                        .addComponent(tratamiento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(estado, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9))
                .addGap(18, 18, 18)
                .addComponent(jButton1)
                .addContainerGap(72, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(500, Short.MAX_VALUE)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(421, 421, 421))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(19, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Ingreso", jPanel1);

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Buscar paciente", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 18))); // NOI18N

        jLabel10.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel10.setText("id de paciente");

        idBusqueda.setText("\n");
        idBusqueda.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                idBusquedaKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                idBusquedaKeyTyped(evt);
            }
        });

        BusquedaPorId.setText("Buscar");
        BusquedaPorId.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                BusquedaPorIdMouseClicked(evt);
            }
        });
        BusquedaPorId.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BusquedaPorIdActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(18, 18, 18)
                .addComponent(jLabel10)
                .addGap(18, 18, 18)
                .addComponent(idBusqueda, javax.swing.GroupLayout.PREFERRED_SIZE, 215, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(BusquedaPorId)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(26, 26, 26)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(idBusqueda, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(BusquedaPorId))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder("Datos paciente"));

        jLabel12.setText("Nombre");

        jLabel13.setText("Edad");

        jLabel14.setText("Rut");

        buttonGroup2.add(mRest);
        mRest.setSelected(true);
        mRest.setText("Masculino");

        buttonGroup2.add(fRest);
        fRest.setText("Femenino");

        edadRespuesta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                edadRespuestaActionPerformed(evt);
            }
        });
        edadRespuesta.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                edadRespuestaKeyTyped(evt);
            }
        });

        jLabel15.setText("Genero");

        jLabel16.setText("Estado del pais");

        jLabel17.setText("Patologia");

        jLabel18.setText("Estado paciente");

        jLabel20.setText("Tratamiento");

        estadoPaisRespuesta.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "ALABAMA", "ALASKA", "ARIZONA", "ARKANSAS", "CALIFORNIA", "COLORADO", "CONNECTICUT", "DELAWARE", "FLORIDA", "HAWAII", "IDAHO", "ILLINOIS", "INDIANA", "IOWA", "KANSAS", "KENTUCKY", "LOUSIANA", "MAINE", "MARYLAND", "MASSACHUSETTS", "MICHIGAN", "MINESOTA", "MISIISSIPPI", "MISSOURI", "MONTANA", "NEBRASKA", "NEVADA", "NEW YORK", "NEW HAMPSHIRE", "NEW JERSEY", "NEW MEXICO", "NORTH DAKOTA", "NORTH CAROLINA", "OHIO", "OKLAHOMA", "OREGON", "PENSILVANIA", "RHODE ISLAND", "SOUTH CAROLINA", "SOUTH DAKOTA", "TENNESSEE", "TEXAS", "UTAH", "VERMONT", "WEST VIRGINIA", "WASHINGTON", "WISCONSIN", "WYOMING" }));

        ActualizarDatos.setText("Actualizar Datos");
        ActualizarDatos.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ActualizarDatosActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(65, 65, 65)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel6Layout.createSequentialGroup()
                        .addComponent(jLabel13)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(edadRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, 214, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel6Layout.createSequentialGroup()
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel12)
                            .addComponent(jLabel15)
                            .addComponent(jLabel16)
                            .addComponent(jLabel14)
                            .addComponent(jLabel17)
                            .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(jLabel18, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(jLabel20, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 36, Short.MAX_VALUE)
                        .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addGroup(jPanel6Layout.createSequentialGroup()
                                    .addComponent(mRest)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(fRest))
                                .addComponent(nombreRespuesta)
                                .addComponent(rutRespuesta)
                                .addComponent(patologiaRespuesta)
                                .addComponent(tratamientoRespuesta)
                                .addComponent(estadoRespuesta)
                                .addComponent(estadoPaisRespuesta, 0, 214, Short.MAX_VALUE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                                .addComponent(ActualizarDatos)
                                .addGap(69, 69, 69)))))
                .addGap(32, 32, 32))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nombreRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel12))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(edadRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel14)
                    .addComponent(rutRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(mRest)
                    .addComponent(fRest)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel16)
                    .addComponent(estadoPaisRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel17)
                    .addComponent(patologiaRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel20)
                    .addComponent(tratamientoRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel18)
                    .addComponent(estadoRespuesta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(32, 32, 32)
                .addComponent(ActualizarDatos)
                .addContainerGap(81, Short.MAX_VALUE))
        );

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Listar Pacientes Por Rut", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 18))); // NOI18N

        jLabel21.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel21.setText("Rut");

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Id", "Rut", "Nombre", "Edad", "Genero", "Estado_pais", "Patologia", "Tratamiento", "Estado_Paciente"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane1.setViewportView(jTable1);

        Buscar.setText("Buscar");
        Buscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BuscarActionPerformed(evt);
            }
        });

        jLabel22.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        jLabel22.setText("Borrar paciente por id");

        idABorrar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                idABorrarKeyTyped(evt);
            }
        });

        borrarPaciente.setText("Borrar");
        borrarPaciente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                borrarPacienteActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel21)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(rutBusqueda, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(31, 31, 31)
                        .addComponent(Buscar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 243, Short.MAX_VALUE)
                        .addComponent(jLabel22)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(idABorrar, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(borrarPaciente)))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel21)
                    .addComponent(rutBusqueda, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Buscar)
                    .addComponent(jLabel22)
                    .addComponent(idABorrar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(borrarPaciente))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane1)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );

        jTabbedPane1.addTab("Busqueda", jPanel2);

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Elija su consulta de analisis", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 1, 18))); // NOI18N

        jLabel11.setFont(new java.awt.Font("Segoe UI", 1, 18)); // NOI18N

        comboBoxConsultas.setFont(new java.awt.Font("Segoe UI", 1, 14)); // NOI18N
        comboBoxConsultas.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1) ¿Cuantos pacientes han mutado por la vacuna sputnik1 por estado?", "2) ¿Cual es la extension del rango medio de edad mas afectado por la mutacion?", "3)  Cantidad de infectados por fecha en cada estado del paıs", "4)  Ratio de recuperados vs mutados por estado", "5)  Cantidad de muertos por estado", "6)  Ratio de mutados entre mujeres y hombres" }));

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null},
                {null},
                {null},
                {null}
            },
            new String [] {
                "Resolucion de datos"
            }
        ));
        jScrollPane2.setViewportView(jTable2);

        Consultar.setText("Consultar");
        Consultar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ConsultarActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel11)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel8Layout.createSequentialGroup()
                .addContainerGap(301, Short.MAX_VALUE)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(comboBoxConsultas, javax.swing.GroupLayout.PREFERRED_SIZE, 685, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(Consultar))
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 778, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(240, 240, 240))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel11)
                .addGap(59, 59, 59)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(comboBoxConsultas, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Consultar, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(44, 44, 44)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(99, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        jTabbedPane1.addTab("Analisis", jPanel3);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jTabbedPane1)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void masculinoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_masculinoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_masculinoActionPerformed

    private void ComboBoxCentroDeSaludActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ComboBoxCentroDeSaludActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_ComboBoxCentroDeSaludActionPerformed

    private void jButton1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jButton1MouseClicked
        String sexo = null;
        String rutf =  formateador(rut.getText());
        
        boolean campos = camposLlenos(nombre.getText(), rutf, edad.getText(),patologia.getText(), 
                tratamiento.getText(),estado.getText());
            if(masculino.isSelected()){
                sexo = "MASCULINO";
                if(!campos)
                {
                    JOptionPane.showMessageDialog(null, "faltan llenar campos");
                    
                }else if(!validarRut(rutf)){
                    JOptionPane.showMessageDialog(null, "Rut invalido");
                    
                }else if(Integer.parseInt(edad.getText())<0)   
                {
                    JOptionPane.showMessageDialog(null, "Edad invalida");
                }else{
                    
                    conect.insertarPaciente(ComboBoxCentroDeSalud.getSelectedItem().toString().toUpperCase(), nombre.getText().toLowerCase(),
                            rutf, Integer.parseInt(edad.getText()),
                            sexo, ComboBoxEstados.getSelectedItem().toString().toUpperCase() , patologia.getText().toLowerCase(),
                            tratamiento.getText().toLowerCase(), estado.getText().toLowerCase());
                    JOptionPane.showMessageDialog(null, "Paciente Ingresado");
                }
            }else if(femenino.isSelected()){
                sexo = "FEMENINO";
                if(!campos)
                {
                    JOptionPane.showMessageDialog(null, "faltan llenar campos");
                    
                }else if(!validarRut(rutf)){
                    
                    JOptionPane.showMessageDialog(null, "Rut invalido");
                    
                }else if(Integer.parseInt(edad.getText())<0)   
                {
                    JOptionPane.showMessageDialog(null, "Edad invalida");
                }else{
                    conect.insertarPaciente(ComboBoxCentroDeSalud.getSelectedItem().toString(), nombre.getText().toUpperCase(),
                            rutf, Integer.parseInt(edad.getText()),
                            sexo, ComboBoxEstados.getSelectedItem().toString().toUpperCase(), patologia.getText().toUpperCase(),
                            tratamiento.getText().toUpperCase(), estado.getText().toUpperCase());
                    JOptionPane.showMessageDialog(null, "Paciente Ingresada");
                }
            }else{
                JOptionPane.showMessageDialog(null, "Seleciona un genero");
            }  
    }//GEN-LAST:event_jButton1MouseClicked
    private String formateador(String rut){
        String rutf = rut.toUpperCase();
        rutf = rutf.replace(" ", "");
        rutf = rutf.replace(".", "");
        rutf = rutf.replace("-", "");
        return rutf;
    }
    public boolean validarRut(String rut) {
        boolean validacion = false;
        try {
                rut =  rut.toUpperCase();
                rut = rut.replace(" ", "");
                rut = rut.replace(".", "");
                rut = rut.replace("-", "");
                int rutAux = Integer.parseInt(rut.substring(0, rut.length() - 1));

                char dv = rut.charAt(rut.length() - 1);

                int m = 0, s = 1;
                for (; rutAux != 0; rutAux /= 10) {
                    s = (s + rutAux % 10 * (9 - m++ % 6)) % 11;
                }
                if (dv == (char) (s != 0 ? s + 47 : 75)) {
                    validacion = true;
                }

            } catch (java.lang.NumberFormatException e) {
            } catch (Exception e) {
            }
            return validacion;
    }
    private boolean camposLlenos(String nombre, String rut, String edad, String patologia, String tratamiento, String estado){
        boolean llenos= true;
        if(nombre.length()==0 || (rut.length()==0) || (edad.length()==0) || patologia.length()==0 || tratamiento.length()==0 || estado.length()==0){
            System.out.println("entra");
            return llenos = false;
        }
        return llenos;
    }
    private void edadKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_edadKeyTyped
        char validar = evt.getKeyChar();
        
        if(Character.isLetter(validar)){
            getToolkit().beep();
            evt.consume();
            
            JOptionPane.showMessageDialog(rootPane,"Ingresar solo numeros");
        }
    }//GEN-LAST:event_edadKeyTyped

    private void BusquedaPorIdMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_BusquedaPorIdMouseClicked
        
        Paciente pa = new Paciente ();
        pa = conect.BusquedaPorId(Integer.parseInt(idBusqueda.getText().replaceAll(" ", "")));
        if(pa.getNombre_r()!=null){
            nombreRespuesta.setText(pa.getNombre_r());
            edadRespuesta.setText(String.valueOf(pa.getEdad_r()));
            rutRespuesta.setText(pa.getRut_r());
            String sexo = pa.getSexo_r();
            if (sexo.equals("MASCULINO"))
            {
                mRest.setSelected(true);
            }
            else
            {
                fRest.setSelected(true);
            }           
            estadoPaisRespuesta.setSelectedItem(pa.getEstadoPais_r());
            patologiaRespuesta.setText(pa.getPatologia_r());
            tratamientoRespuesta.setText(pa.getTratam_r());
            estadoRespuesta.setText(pa.getEstadoPaciente_r());
        }   
        
    }//GEN-LAST:event_BusquedaPorIdMouseClicked

    private void edadRespuestaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_edadRespuestaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_edadRespuestaActionPerformed

    private void BusquedaPorIdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BusquedaPorIdActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_BusquedaPorIdActionPerformed

    private void BuscarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BuscarActionPerformed
        String rut = formateador(rutBusqueda.getText());
        if(validarRut(rut)){
            List<String []> datos=conect.listadoPacientePorRut(rut);
            modelo = new DefaultTableModel();
            jTable1.setModel(modelo);
            modelo.addColumn("id");
            modelo.addColumn("rut");
            modelo.addColumn("nombre");
            modelo.addColumn("edad");
            modelo.addColumn("genero");
            modelo.addColumn("estado_pais");
            modelo.addColumn("Patologia");
            modelo.addColumn("tratamiento");
            modelo.addColumn("estado");
            int [] anchos = {5,50,20,20,50,50,100,100,80};
            for (int i = 0; i < 9; i++) {
                jTable1.getColumnModel().getColumn(i).setPreferredWidth(anchos[i]);
            }
            modelo.getDataVector().removeAllElements();
            for (int i = 0; i < datos.size(); i++) {
                modelo.addRow(datos.get(i));
            }
        }else{
            JOptionPane.showMessageDialog(rootPane,"Ingresar Rut Valido");
        }
        
    }//GEN-LAST:event_BuscarActionPerformed

    private void borrarPacienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_borrarPacienteActionPerformed
        int id = Integer.parseInt(idABorrar.getText().replaceAll(" ", ""));
        String rut = conect.rutDeUnaId(id);
        conect.borrarPorId(Integer.parseInt(idABorrar.getText()));
        List<String []> datos=conect.listadoPacientePorRut(rut);
            modelo = new DefaultTableModel();
            jTable1.setModel(modelo);
            modelo.addColumn("id");
            modelo.addColumn("rut");
            modelo.addColumn("nombre");
            modelo.addColumn("edad");
            modelo.addColumn("genero");
            modelo.addColumn("estado_pais");
            modelo.addColumn("Patologia");
            modelo.addColumn("tratamiento");
            modelo.addColumn("estado");
             int [] anchos = {5,50,20,20,50,50,100,100,80};
            for (int i = 0; i < 9; i++) {
                jTable1.getColumnModel().getColumn(i).setPreferredWidth(anchos[i]);
            }
            modelo.getDataVector().removeAllElements();
            for (int i = 0; i < datos.size(); i++) {
                modelo.addRow(datos.get(i));
            }
    }//GEN-LAST:event_borrarPacienteActionPerformed

    private void ConsultarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ConsultarActionPerformed
        int index =comboBoxConsultas.getSelectedIndex()+1;
         List<String []> datos = new ArrayList<String []>();
       
         switch(index){
               case 1:
                    datos = conect.consultas(index);
                    modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Estado");
                    modelo.addColumn("Cantidad de Pacientes");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    }          
                   break;
               case 2:
                   datos = conect.consultas(index);
                   modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Rango");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    }   
                   break;
               case 3:
                   datos = conect.consultas(index);
                   modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Estado Pais");
                    modelo.addColumn("Fecha");
                    modelo.addColumn("Cantidad");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    }   
                   break;
               case 4:
                   datos = conect.consultas(index);
                   modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Estado Pais");
                    modelo.addColumn("Mutados es a Recuperados");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    } 
                   break;
               case 5:
                   datos = conect.consultas(index);
                   modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Estado Pais");
                    modelo.addColumn("Cantidad de Muertos");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    } 
                   break;
               case 6:
                   datos = conect.consultas(index);
                   modelo = new DefaultTableModel();
                    this.jTable2.setModel(modelo);

                    modelo.addColumn("Relacion de mutados Hombres es a mujeres");
                    modelo.getDataVector().removeAllElements();
                    
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    } 
                   break;    
            }
    }//GEN-LAST:event_ConsultarActionPerformed

    private void ActualizarDatosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ActualizarDatosActionPerformed
        String rut = formateador(rutRespuesta.getText());
        int id = Integer.parseInt(idBusqueda.getText().replaceAll(" ", ""));
        int edad = Integer.parseInt(edadRespuesta.getText().replaceAll(" ", ""));
        if(validarRut(rut)){
            if(edad>=0){
                if(mRest.isSelected()){
                    conect.actualizar(nombreRespuesta.getText().toUpperCase(), edad, rut, "MASCULINO",
                        estadoPaisRespuesta.getSelectedItem().toString().toUpperCase(), patologiaRespuesta.getText().toLowerCase(), 
                        tratamientoRespuesta.getText().toLowerCase(), estadoRespuesta.getText().toLowerCase(),id);
                    List<String []> datos=conect.listadoPacientePorRut(formateador(rutRespuesta.getText()));
                    modelo = new DefaultTableModel();
                    jTable1.setModel(modelo);
                    modelo.addColumn("id");
                    modelo.addColumn("rut");
                    modelo.addColumn("nombre");
                    modelo.addColumn("edad");
                    modelo.addColumn("genero");
                    modelo.addColumn("estado_pais");
                    modelo.addColumn("Patologia");
                    modelo.addColumn("tratamiento");
                    modelo.addColumn("estado");
                    int [] anchos = {5,50,20,20,50,50,100,100,80};
                    for (int i = 0; i < 9; i++) {
                        jTable1.getColumnModel().getColumn(i).setPreferredWidth(anchos[i]);
                    }
                    modelo.getDataVector().removeAllElements();
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    }
                }
                else{
                    conect.actualizar(nombreRespuesta.getText().toUpperCase(), edad, rut, "FEMENINO",
                    estadoPaisRespuesta.getSelectedItem().toString().toUpperCase(), patologiaRespuesta.getText().toLowerCase(), 
                    tratamientoRespuesta.getText().toLowerCase(), estadoRespuesta.getText().toLowerCase(),id);
                    List<String []> datos=conect.listadoPacientePorRut(formateador(rutRespuesta.getText()));
                    modelo = new DefaultTableModel();
                    jTable1.setModel(modelo);
                    modelo.addColumn("id");
                    modelo.addColumn("rut");
                    modelo.addColumn("nombre");
                    modelo.addColumn("edad");
                    modelo.addColumn("genero");
                    modelo.addColumn("estado_pais");
                    modelo.addColumn("Patologia");
                    modelo.addColumn("tratamiento");
                    modelo.addColumn("estado");
                    int [] anchos = {5,50,20,20,50,50,100,100,80};
                    for (int i = 0; i < 9; i++) {
                        jTable1.getColumnModel().getColumn(i).setPreferredWidth(anchos[i]);
                    }
                    modelo.getDataVector().removeAllElements();
                    for (int i = 0; i < datos.size(); i++) {
                        modelo.addRow(datos.get(i));
                    }
                }
            }else{
                JOptionPane.showMessageDialog(rootPane,"Edad Invalida, deben ser numeron positivos");
            }
        }else{
            JOptionPane.showMessageDialog(rootPane,"Ingresar Rut Valido");
        }    
    }//GEN-LAST:event_ActualizarDatosActionPerformed

    private void idBusquedaKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_idBusquedaKeyPressed
        if(evt.getKeyCode() == KeyEvent.VK_ENTER){
            Paciente pa = new Paciente ();
        pa = conect.BusquedaPorId(Integer.parseInt(idBusqueda.getText().replaceAll(" ", "")));
        if(pa.getNombre_r()!=null){
            nombreRespuesta.setText(pa.getNombre_r());
            edadRespuesta.setText(String.valueOf(pa.getEdad_r()));
            rutRespuesta.setText(pa.getRut_r());
            String sexo = pa.getSexo_r();
            if (sexo.equals("MASCULINO"))
            {
                mRest.setSelected(true);
            }
            else
            {
                fRest.setSelected(true);
            }           
            estadoPaisRespuesta.setSelectedItem(pa.getEstadoPais_r());
            patologiaRespuesta.setText(pa.getPatologia_r());
            tratamientoRespuesta.setText(pa.getTratam_r());
            estadoRespuesta.setText(pa.getEstadoPaciente_r());
        }   
        }
    }//GEN-LAST:event_idBusquedaKeyPressed

    private void idBusquedaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_idBusquedaKeyTyped
        char validar = evt.getKeyChar();
        
        if(Character.isLetter(validar)){
            getToolkit().beep();
            evt.consume();
            
            JOptionPane.showMessageDialog(rootPane,"Ingresar solo numeros");
        }
    }//GEN-LAST:event_idBusquedaKeyTyped

    private void edadRespuestaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_edadRespuestaKeyTyped
        char validar = evt.getKeyChar();
        
        if(Character.isLetter(validar)){
            getToolkit().beep();
            evt.consume();
            
            JOptionPane.showMessageDialog(rootPane,"Ingresar solo numeros");
        }
    }//GEN-LAST:event_edadRespuestaKeyTyped

    private void idABorrarKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_idABorrarKeyTyped
        char validar = evt.getKeyChar();
        
        if(Character.isLetter(validar)){
            getToolkit().beep();
            evt.consume();
            
            JOptionPane.showMessageDialog(rootPane,"Ingresar solo numeros");
        }
    }//GEN-LAST:event_idABorrarKeyTyped
     
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Main.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Main().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton ActualizarDatos;
    private javax.swing.JButton Buscar;
    private javax.swing.JButton BusquedaPorId;
    private javax.swing.JComboBox<String> ComboBoxCentroDeSalud;
    private javax.swing.JComboBox<String> ComboBoxEstados;
    private javax.swing.JButton Consultar;
    private javax.swing.JButton borrarPaciente;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JComboBox<String> comboBoxConsultas;
    private javax.swing.JTextField edad;
    private javax.swing.JTextField edadRespuesta;
    private javax.swing.JTextField estado;
    private javax.swing.JComboBox<String> estadoPaisRespuesta;
    private javax.swing.JTextField estadoRespuesta;
    private javax.swing.JRadioButton fRest;
    private javax.swing.JRadioButton femenino;
    private javax.swing.JTextField idABorrar;
    private javax.swing.JTextField idBusqueda;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JRadioButton mRest;
    private javax.swing.JRadioButton masculino;
    private javax.swing.JTextField nombre;
    private javax.swing.JTextField nombreRespuesta;
    private javax.swing.JTextField patologia;
    private javax.swing.JTextField patologiaRespuesta;
    private javax.swing.JTextField rut;
    private javax.swing.JTextField rutBusqueda;
    private javax.swing.JTextField rutRespuesta;
    private javax.swing.JTextField tratamiento;
    private javax.swing.JTextField tratamientoRespuesta;
    // End of variables declaration//GEN-END:variables
}
